# Backend (Express)
NODE_ENV=production
PORT=4000
GRACEFUL_SHUTDOWN_TIMEOUT_MS=10000
# Run Prisma migrations on start (set false for multi-instance deploys)
RUN_MIGRATIONS_ON_START=true
# Optional HTTP server timeouts (ms)
# SERVER_KEEP_ALIVE_TIMEOUT_MS=5000
# SERVER_HEADERS_TIMEOUT_MS=60000
# SERVER_REQUEST_TIMEOUT_MS=300000

# Database
# MUST use PostgreSQL for production
DATABASE_URL=postgresql://user:password@host:5432/bazi_master?schema=public

# Networking & CORS
# Base URL for the backend API
BACKEND_BASE_URL=https://api.yourdomain.com
# URL of the frontend application (for CORS and redirects)
FRONTEND_URL=https://app.yourdomain.com
# Comma-separated list of allowed origins
CORS_ALLOWED_ORIGINS=https://app.yourdomain.com
# Trust proxy hops (set to 1 for a single reverse proxy)
TRUST_PROXY=1

# Session & Security
# MUST be set to a long random string (32+ chars)
SESSION_TOKEN_SECRET=change_this_to_a_secure_random_string_in_production
# Cookie settings (adjust SameSite to "none" when frontend/api are cross-site)
SESSION_COOKIE_SAMESITE=strict
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_DOMAIN=
# Comma-separated list of admin emails
ADMIN_EMAILS=admin@yourdomain.com

# Redis (Caching & Session Store)
# REQUIRED for production to ensure consistent sessions/caching
REDIS_URL=redis://redis-host:6379

# AI Providers (optional)
# Set AI_PROVIDER to 'openai', 'anthropic' or 'mock'
AI_PROVIDER=openai
OPENAI_API_KEY=your_openai_key
OPENAI_MODEL=gpt-4o-mini
ANTHROPIC_API_KEY=your_anthropic_key
ANTHROPIC_MODEL=claude-3-5-sonnet-20240620
AI_MAX_TOKENS=1000
AI_TIMEOUT_MS=20000

# Limits
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=100

# Documentation Security
# Username for API docs (Basic Auth). Defaults to 'admin' if not set.
DOCS_USER=admin
# Password for API docs (Basic Auth). REQUIRED in production if you want to access /api-docs.
DOCS_PASSWORD=secure_docs_password_change_me

# Auth/OAuth (optional)
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=
WECHAT_APP_ID=
WECHAT_APP_SECRET=
WECHAT_SCOPE=snsapi_login
WECHAT_FRONTEND_URL=
WECHAT_REDIRECT_URI=

# Email (password reset)
PASSWORD_RESET_ENABLED=true
SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_smtp_user
SMTP_PASS=your_smtp_password
SMTP_FROM="BaZi Master <no-reply@yourdomain.com>"
SMTP_REPLY_TO=
SMTP_TIMEOUT_MS=10000
PASSWORD_RESET_SUBJECT=

# Safety switches
# Ensure these are false in production
ALLOW_DEV_OAUTH=false
ALLOW_SQLITE_PROD=false
ALLOW_LOCALHOST_PROD=false
SEED_DEFAULT_USER=false
SEED_USER_EMAIL=
SEED_USER_PASSWORD=
PASSWORD_RESET_DEBUG_LOG=false

# Sentry (Error Tracking)
SENTRY_DSN=
VITE_SENTRY_DSN=
